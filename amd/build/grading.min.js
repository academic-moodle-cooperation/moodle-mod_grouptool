define(["jquery","core/config","core/str","core/log"],function(a,b,c,d){var e=function(){this.contextid=0,this.lang="",this.SELECTORS={GROUPINGSELECT:"select[name=grouping]",GROUPSELECT:"select[name=filter]"}};e.prototype.update_groups=function(c){var e=0;d.info("Update groups!","grouptool"),e=a(c.data.SELECTORS.GROUPINGSELECT).val(),e<0&&(e=0);var f=c.data.contextid,g={method:"get",url:b.wwwroot+"/mod/grouptool/groupinggroups_ajax.php",data:{groupingid:e,lang:b.lang,contextid:f},dataType:"json",beforeSend:function(){d.info("Request groups for grouping "+e,"grouptool")},success:function(b){if(b.error)d.error(b.error,"grouptool");else{var e="",f=-1;f=a(c.data.SELECTORS.GROUPSELECT).val();for(var g=0;g<b.length;g++)e+=a(c.data.SELECTORS.GROUPSELECT).filter(' option[value="'+b[g].id+'"]')&&a(c.data.SELECTORS.GROUPSELECT).filter(' option[value="'+b[g].id+'"]').get("selected")?'\n<option value="'+b[g].id+'" selected="selected">'+b[g].name+"</option>":'\n<option value="'+b[g].id+'">'+b[g].name+"</option>";a(c.data.SELECTORS.GROUPSELECT).html(e),a(c.data.SELECTORS.GROUPSELECT).val(f)}},error:function(a,b){d.error(b,"grouptool")}};a.ajax(g)};var f=new e;return f.initializer=function(b){f.contextid=b.contextid,a(this.SELECTORS.GROUPINGSELECT).on("change",null,this,f.update_groups)},f});