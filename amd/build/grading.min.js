/**
 * JS handling select box content in group grading tab
 *
 * @module   mod_grouptool/grading
 * @author    Philipp Hager
 * @copyright 2014 Academic Moodle Cooperation {@link http://www.academic-moodle-cooperation.org}
 * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("mod_grouptool/grading",["jquery","core/config","core/str","core/log"],(function($,config,str,log){var Grading=function(){this.contextid=0,this.lang="",this.SELECTORS={GROUPINGSELECT:"select[name=grouping]",GROUPSELECT:"select[name=filter]"}};Grading.prototype.updateGroups=function(e){var groupingid=0;log.info("Update groups!","grouptool"),(groupingid=$(e.data.SELECTORS.GROUPINGSELECT).val())<0&&(groupingid=0);var contextid=e.data.contextid,cfg={method:"get",url:config.wwwroot+"/mod/grouptool/groupinggroups_ajax.php",data:{groupingid:groupingid,lang:config.lang,contextid:contextid},dataType:"json",beforeSend:function(){log.info("Request groups for grouping "+groupingid,"grouptool")},success:function(data){if(data.error)log.error(data.error,"grouptool");else{for(var options="",oldsel=$(e.data.SELECTORS.GROUPSELECT).val(),i=0;i<data.length;i++)$(e.data.SELECTORS.GROUPSELECT).filter(' option[value="'+data[i].id+'"]')&&$(e.data.SELECTORS.GROUPSELECT).filter(' option[value="'+data[i].id+'"]').get("selected")?options+='\n<option value="'+data[i].id+'" selected="selected">'+data[i].name+"</option>":options+='\n<option value="'+data[i].id+'">'+data[i].name+"</option>";$(e.data.SELECTORS.GROUPSELECT).html(options),$(e.data.SELECTORS.GROUPSELECT).val(oldsel)}},error:function(jqXHR,error){log.error(error,"grouptool")}};$.ajax(cfg)};var instance=new Grading;return instance.initializer=function(params){instance.contextid=params.contextid,$(this.SELECTORS.GROUPINGSELECT).on("change",null,this,instance.updateGroups);var form=$("#grading_form"),selects=form.find('input[name="selected[]"]');form.on("click",".checkboxcontroller a.select_all",(function(e){e.stopPropagation(),e.preventDefault(),selects.prop("checked",!0)})),form.on("click",".checkboxcontroller a.select_none",(function(e){e.stopPropagation(),e.preventDefault(),selects.prop("checked",!1)}))},instance}));

//# sourceMappingURL=grading.min.js.map