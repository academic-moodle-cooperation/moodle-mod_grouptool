define(["jquery","core/modal_factory","core/templates","core/url","core/str","core/log"],function(a,b,c,d,e,f){var g=function(){this.showidnumber=!1,this.courseid=""},h=new g;return h.initializer=function(g){h.showidnumber=g.showidnumber,h.courseid=g.courseid,f.info("Initialize groupmembers JS!","mod_grouptool"),h.modal||(h.modalpromise=b.create({type:b.types.MODAL,body:"..."})),e.get_string("groupmembers").done(function(b){f.info("Done loading strings...","mod_grouptool"),h.modalpromise.done(function(e){f.info("Done preparing modal...","mod_grouptool"),h.modal=e,a("#registration_form").on("click","span.memberstooltip > a",null,function(e){e.stopPropagation(),e.preventDefault();var f,g=a(e.target),i=g.parents("form").data("statushelp");try{f=g.data("absregs")}catch(j){f=[]}var k;try{k=g.data("gtregs")}catch(j){k=[]}var l;try{l=g.data("mregs")}catch(j){l=[]}var m;try{m=g.data("queued")}catch(j){m=[]}var n;try{n=b+": "+g.data("name")}catch(j){n=b}var o={courseid:h.courseid,showidnumber:h.showidnumber,profileurl:d.relativeUrl("/user/view.php?course="+h.courseid+"&id="),statushelp:i,absregs:f,gtregs:k,mregs:l,queued:m},p=c.render("mod_grouptool/groupmembers",o);p.done(function(a){h.modal.setTitle(n),h.modal.setBody(a),h.modal.show()}).fail(function(a){h.modal.setBody(a.message),h.modal.show()})})})}).fail(function(a){f.error("Error getting strings: "+a,"mod_grouptool")})},h});