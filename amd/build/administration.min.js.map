{"version":3,"file":"administration.min.js","sources":["../src/administration.js"],"sourcesContent":["// This file is part of mod_grouptool for Moodle - http://moodle.org/\n//\n// It is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// It is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript for group administration (rename, resize, toggle and deletion)\n *\n * @module   mod_grouptool/administration\n * @author    Philipp Hager\n * @copyright 2014 Academic Moodle Cooperation {@link http://www.academic-moodle-cooperation.org}\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n /**\n  * @module mod_grouptool/administration\n  */\ndefine(['jquery', 'core/templates', 'core/ajax', 'core/str', 'core/url', 'core/notification', 'core/log'], function($, templates,\n        ajax, str, murl, notif, log) {\n\n    /**\n     * @constructor\n     * @alias module:mod_grouptool/administration\n     */\n    var Administration = function() {\n        this.cmid = 0;\n        this.filter = null;\n        this.filterall = null;\n        this.globalsize = 3;\n    };\n\n    /**\n     * Rename 1 moodle group via AJAX request.\n     *\n     * @param {Event} e Event object\n     */\n    Administration.prototype.renamegroup = function(e) {\n        log.info('Rename Group!', 'grouptool');\n        e.preventDefault();\n        e.stopPropagation();\n\n        var context = {};\n        var requests = [];\n\n        // Get group id!\n        var target = $(e.target).closest('[data-rename]');\n        var node = target.closest('tr');\n        var grpid = node.data('id');\n\n        var button = target;\n        var field = button.prevAll('input[type=hidden]');\n        var text = button.prevAll('span.text');\n        var infoNode = '';\n        button.fadeOut(600);\n        field.fadeOut(600);\n        text.fadeOut(600, function() {\n            field.attr('type', 'text');\n            field.fadeIn(600);\n            field.focus();\n            field.select();\n        });\n        field.on('keydown', null, e.data, function(e) {\n            if (e.which === 13 || e.which === 27) {\n                e.preventDefault();\n                e.stopPropagation();\n            }\n\n            if (e.which === 13) { // Enter!\n                requests = ajax.call([{\n                    methodname: 'mod_grouptool_rename_group',\n                    args: {cmid: e.data.cmid, groupid: grpid, name: field.val()},\n                    fail: notif.exception\n                }]);\n                if (infoNode) {\n                    infoNode.fadeOut(600);\n                    infoNode.remove();\n                }\n                requests[0].then(function(result) {\n                    if (result.error) {\n                        context = {\n                            'message': result.error\n                        };\n                        templates.render('core/notification_error', context).then(function(html) {\n                            infoNode = $(html);\n                            infoNode.hide();\n                            node.find('.grpname div').prepend(infoNode);\n                            infoNode.fadeIn(600);\n                            // Remove after 60 seconds automatically!\n                            window.setTimeout(function() {\n                                infoNode.fadeOut(600, function() {\n                                    infoNode.remove();\n                                });\n                            }, 60 * 1000);\n\n                            return this;\n                        }).fail(notif.exception);\n                    } else {\n                        context = {\n                            'message': result.message\n                        };\n                        templates.render('core/notification_success', context).then(function() {\n\n                            text.html(field.val());\n                            field.fadeOut(600, function() {\n                                field.attr('value', field.val());\n                                field.attr('type', 'hidden');\n                                text.fadeIn(600);\n                                button.fadeIn(600);\n                            });\n                            field.off('keydown');\n\n                            return this;\n                        }).fail(notif.exception);\n\n                        log.info(\"AJAX Call to rename group \" + grpid + \" successfull\\n\" + status, \"grouptool\");\n                    }\n\n                    return this;\n                }).fail(notif.exception);\n\n            } else if (e.which === 27) { // Escape!\n                field.fadeOut(600, function() {\n                    text.hide();\n                    field.attr('type', 'hidden');\n                    field.val(text.html());\n                    field.attr('value', text.html());\n                    text.fadeIn(600);\n                    button.fadeIn(600);\n                });\n                if (infoNode) {\n                    infoNode.fadeOut(600, function() {\n                        infoNode.remove();\n                    });\n                }\n                field.unbind('key');\n            }\n        });\n    };\n\n    /**\n     * Change maximum group size of 1 moodle group via AJAX request.\n     *\n     * @param {Event} e Event object\n     */\n    Administration.prototype.resizegroup = function(e) {\n        log.info('Resize Group!', 'grouptool');\n        e.preventDefault();\n        e.stopPropagation();\n\n        // Get group id!\n        var target = $(e.target).closest('[data-resize]');\n        var node = target.closest('tr');\n        var grpid = node.data('id');\n\n        var cmid = e.data.instance.cmid;\n\n        var strings = e.data.strings;\n        var globalsize = e.data.globalsize;\n\n        var button = target;\n        var field = button.prevAll('input[type=hidden]');\n        var text = button.prevAll('span.text');\n        var infoNode = '';\n        var helpNode = '';\n\n        var context = {};\n        var requests = [];\n\n        button.fadeOut(600);\n        field.fadeOut(600);\n        text.fadeOut(600, function() {\n            field.attr('type', 'text');\n            field.fadeIn(600);\n            field.focus();\n            field.select();\n            var context = {\n                'message': strings.resizehelp\n            };\n            templates.render('core/notification_info', context).then(function(html) {\n                helpNode = $(html);\n                helpNode.hide();\n                node.find('.size div').prepend(helpNode);\n                helpNode.fadeIn(600);\n\n                return this;\n            }).fail(notif.exception);\n        });\n        field.on('keydown', null, null, function(e) {\n            if (e.which === 13 || e.which === 27) {\n                e.preventDefault();\n                e.stopPropagation();\n            }\n\n            if (e.which === 13) { // Enter!\n                requests = ajax.call([{\n                    methodname: 'mod_grouptool_resize_group',\n                    args: {cmid: parseInt(cmid), groupid: grpid, size: field.val()},\n                    fail: notif.exception\n                }]);\n                if (infoNode) {\n                    infoNode.fadeOut(600);\n                    infoNode.remove();\n                }\n                if (helpNode) {\n                    helpNode.fadeOut(600);\n                    helpNode.remove();\n                }\n                requests[0].then(function(result) {\n                    if (result.error) {\n                        context = {\n                            'message': result.error\n                        };\n                        templates.render('core/notification_error', context).then(function(html) {\n                            infoNode = $(html);\n                            infoNode.hide();\n                            node.find('.size div').prepend(infoNode);\n                            infoNode.fadeIn(600);\n                            // Remove after 60 seconds automatically!\n                            window.setTimeout(function() {\n                                infoNode.fadeOut(600, function() {\n                                    infoNode.remove();\n                                });\n                            }, 60 * 1000);\n\n                            return this;\n                        }).fail(notif.exception);\n                    } else {\n                        context = {\n                            'message': result.message\n                        };\n                        templates.render('core/notification_success', context).then(function(html) {\n                            infoNode = $(html);\n                            infoNode.hide();\n                            node.find('.size div').prepend(infoNode);\n                            infoNode.fadeIn(600);\n                            var newvalue = field.val();\n                            if (newvalue === '') {\n                                text.html(globalsize + '*');\n                            } else {\n                                text.html(newvalue);\n                            }\n                            field.fadeOut(600, function() {\n                                field.attr('value', field.val());\n                                field.attr('type', 'hidden');\n                                text.fadeIn(600);\n                                button.fadeIn(600);\n                                field.off('keydown');\n                            });\n                            window.setTimeout(function() {\n                                infoNode.fadeOut(600, function() {\n                                    infoNode.remove();\n                                });\n                            }, 5 * 1000);\n\n                            return this;\n                        }).fail(notif.exception);\n                    }\n                    log.info(\"AJAX Call to resize group \" + grpid + \" successfull\\n\" + status, \"grouptool\");\n\n                    return this;\n                }).fail(notif.exception);\n\n            } else if (e.which === 27) { // Escape!\n                field.fadeOut(600, function() {\n                    text.hide();\n                    field.attr('type', 'hidden');\n                    field.attr('value', text.html());\n                    field.val(text.html());\n                    text.fadeIn(600);\n                    button.fadeIn(600);\n                });\n                if (infoNode) {\n                    infoNode.fadeOut(600, function() {\n                        infoNode.remove();\n                    });\n                }\n                if (helpNode) {\n                    helpNode.fadeOut(600, function() {\n                        infoNode.remove();\n                    });\n                }\n                field.unbind('key');\n            }\n        });\n    };\n\n    /**\n     * Toggle 1 group (active/inactive) and change symbol or remove the HTML node respectively.\n     *\n     * @param {Event} e Event object\n     */\n    Administration.prototype.togglegroup = function(e) {\n        e.preventDefault();\n        e.stopPropagation();\n\n        var requests = [];\n        var context = {};\n\n        var target = $(e.target).closest(\"[data-toggle]\");\n\n        var node = target.closest('tr');\n\n        var grpid = node.data('id');\n\n        log.info('TOGGLE GROUP ' + grpid, \"grouptool\");\n\n        var status = node.data('status');\n\n        if (status === 1 || status === true) {\n            // Set inactive (via AJAX Request)!\n            log.info('DEACTIVATE GROUP ' + grpid + '!', \"grouptool\");\n\n            requests = ajax.call([{\n                methodname: 'mod_grouptool_deactivate_group',\n                args: {cmid: e.data.cmid, groupid: grpid},\n                fail: notif.exception\n            }]);\n            requests[0].then(function(result) {\n                if (result.error) {\n                    var text = \"AJAX Call to deactivate group \" + grpid + \" successfull but error occured:\\n\";\n                    log.info(text + result.error + \"\\n\" + status, \"grouptool\");\n                } else {\n                    if (e.data.filter === 'active') {\n                        node.find('td div').slideUp(600).promise().done(function() {\n                            node.remove();\n                            if (!$('div.sortlist_container tr').length) {\n                                /* TODO: instead we could just switch to filter all via JS/AJAX i.e. render mustache template\n                                 * for all groups sortlist! */\n                                var stringstofetch = [{'key': 'nogroupsactive', 'component': 'mod_grouptool'},\n                                                      {'key': 'nogroupschoose', 'component': 'mod_grouptool'}];\n                                str.get_strings(stringstofetch).done(function(s) {\n                                    var url = murl.relativeUrl('/mod/grouptool/view.php', {\n                                        'id': e.data.cmid,\n                                        'tab': 'group_administration',\n                                        'filter': e.data.filterall\n                                    });\n                                    var link = \"<a href=\\\"\" + url + \"\\\">\" + s[2] + \"</a>\";\n                                    var context = {\n                                        'message': s[0] + link\n                                    };\n                                    var sortlistcontainer = $('div.sortlist_container');\n                                    sortlistcontainer.fadeOut(600, function() {\n                                        templates.render('core/notification_info', context).then(function(html) {\n                                            sortlistcontainer.html(html);\n                                            sortlistcontainer.fadeIn(600);\n\n                                            return this;\n                                        }).fail(notif.exception);\n                                    });\n                                }).fail(notif.exception);\n                            }\n                        }).fail(notif.exception);\n                    } else {\n                        // Render the element again and display it!\n                        var viewparams = {\n                            'id': e.data.cmid,\n                            'tab': 'administration'\n                        };\n                        context = {\n                            \"status\": false,\n                            \"missing\": false,\n                            \"groupings\": target.closest('tr').data('groupings'),\n                            \"id\": grpid,\n                            \"checked\": target.closest('tr').find('input[type=checkbox]').prop('checked'),\n                            \"name\": target.closest('tr').data('name'),\n                            \"pageurl\": murl.relativeUrl(\"/mod/grouptool/view.php\", viewparams, false),\n                            \"order\": target.closest('tr').data('order'),\n                            \"usesize\": !!e.data.usesize,\n                            \"size\": target.closest('tr').data('size')\n                        };\n                        var templatepromise = templates.render('mod_grouptool/sortlist_entry', context);\n                        // This will call the function to load and render our template.\n                        node.toggleClass('slidup');\n                        node.find('td div').slideUp(600).promise().done(function() {\n                            templatepromise.then(function(html) {\n                                var firstinactive = node.parents('table').find('tr[data-status=0], tr[data-status=false]').first();\n                                var lastactive = node.parents('table').find('tr[data-status=1], tr[data-status=true]').last();\n                                if (firstinactive.length) {\n                                    node.detach();\n                                    node.insertBefore(firstinactive);\n                                } else if (lastactive.length) {\n                                    node.detach();\n                                    node.insertAfter(lastactive);\n                                }\n                                var newnode = $(html);\n                                newnode.addClass('slidup');\n                                newnode.find('td div').slideUp(0);\n                                node.replaceWith(newnode);\n                                newnode.find('[data-drag]').removeClass('js_invisible').css('cursor', 'pointer');\n                                newnode.toggleClass('slidup');\n                                newnode.find('td div').slideDown(600);\n                                node = newnode;\n\n                                return this;\n                            }).fail(notif.exception);\n                        }).fail(notif.exception);\n                    }\n                    log.info(\"AJAX Call to deactivate group \" + grpid + \" successfull\\n\" + result.message + \"\\n\" + status,\n                        \"grouptool\");\n                }\n\n                return this;\n            }).fail(notif.exception);\n        } else if (status === 0 || status === false) {\n            // Set active (via AJAX Request)!\n            log.info('ACTIVATE GROUP ' + grpid + '!', \"grouptool\");\n\n            requests = ajax.call([{\n                methodname: 'mod_grouptool_activate_group',\n                args: {cmid: e.data.cmid, groupid: grpid},\n                fail: notif.exception\n            }]);\n            requests[0].then(function(result) {\n                if (result.error) {\n                    var text = \"AJAX Call to activate group \" + grpid + \" successfull but error occured:\\n\";\n                    log.info(text + result.error + \"\\n\" + status, \"grouptool\");\n                } else {\n                    if (e.data.filter === 'inactive') {\n                        // If showing only inactive remove from list!\n                        node.find('td div').slideUp(600).promise().done(function() {\n                            node.remove();\n                            if (!$('div.sortlist_container tr').length) {\n                                /* TODO: instead we could just switch to filter all via JS/AJAX i.e. render mustache template\n                                 * for all groups sortlist! */\n                                var stringstofetch = [\n                                    {'key': 'nogroupsinactive', 'component': 'mod_grouptool'},\n                                    {'key': 'nogroupschoose', 'component': 'mod_grouptool'}\n                                ];\n                                str.get_strings(stringstofetch).done(function(s) {\n                                    var url = murl.relativeUrl('/mod/grouptool/view.php', {\n                                        'id': e.data.cmid,\n                                        'tab': 'group_administration',\n                                        'filter': e.data.filterall\n                                    });\n                                    var link = \"<a href=\\\"\" + url + \"\\\">\" + s[2] + \"</a>\";\n                                    context = {\n                                        'message': s[0] + link\n                                    };\n                                    var sortlistcontainer = $('div.sortlist_container');\n                                    sortlistcontainer.fadeOut(600, function() {\n                                        templates.render('core/notification_info', context).then(function(html) {\n                                            sortlistcontainer.html(html);\n                                            sortlistcontainer.fadeIn(600);\n\n                                            return this;\n                                        }).fail(notif.exception);\n                                    });\n                                }).fail(notif.exception);\n                            }\n                        });\n                    } else {\n                        // Replace sortlist entry!\n                        var viewparams = {\n                            'id': e.data.cmid,\n                            'tab': 'administration'\n                        };\n                        // This will call the function to load and render our template.\n                        context = {\n                            \"status\": true,\n                            \"missing\": false,\n                            \"groupings\": node.data('groupings'),\n                            \"id\": grpid,\n                            \"checked\": node.find('input[type=checkbox]').prop('checked'),\n                            \"name\": node.data('name'),\n                            \"pageurl\": murl.relativeUrl(\"/mod/grouptool/view.php\", viewparams, false),\n                            \"order\": node.data('order'),\n                            \"usesize\": !!e.data.usesize,\n                            \"size\": node.data('size')\n                        };\n                        var templatepromise = templates.render('mod_grouptool/sortlist_entry', context);\n                        node.toggleClass('slidup');\n                        target.closest('tr').find('td div').slideUp(600).promise().done(function() {\n                            templatepromise.then(function(html) {\n                                var firstinactive = node.parents('table').find('tr[data-status=0], tr[data-status=false]').first();\n                                var lastactive = node.parents('table').find('tr[data-status=1], tr[data-status=true]').last();\n                                if (lastactive.length) {\n                                    node.detach();\n                                    node.insertAfter(lastactive);\n                                } else if (firstinactive.length) {\n                                    node.detach();\n                                    node.insertBefore(firstinactive);\n                                }\n                                var newnode = $(html);\n                                newnode.addClass('slidup');\n                                newnode.find('td div').slideUp(0);\n                                node.replaceWith(newnode);\n                                newnode.find('[data-drag]').removeClass('js_invisible').css('cursor', 'pointer');\n                                newnode.toggleClass('slidup');\n                                newnode.find('td div').slideDown(600);\n                                node = newnode;\n\n                                return this;\n                            }).fail(notif.exception);\n                        }).fail(notif.exception);\n                    }\n                    log.info(\"AJAX Call to activate group \" + grpid + \" successfull\\n\" + result.message, \"grouptool\");\n                }\n\n                return this;\n            }).fail(notif.exception);\n        } else {\n            // Error!\n            log.error('Group with id ' + grpid + ' must have either status 1 or 0!', \"grouptool\");\n        }\n    };\n\n    /**\n     * Delete one moodle group via AJAX request.\n     *\n     * @param {Event} e Event object\n     */\n    Administration.prototype.deletegroup = function(e) {\n        e.preventDefault();\n        e.stopPropagation();\n\n        if ($(e.target).closest('[data-delete]').hasClass('disabled')) {\n            return;\n        }\n\n        // Get group id!\n        var target = $(e.target).closest('[data-delete]');\n\n        var node = target.closest('tr');\n\n        var grpid = node.data('id');\n\n        var strings = e.data.strings;\n\n        notif.confirm(strings.title, strings.confirm, strings.yes, strings.no, function() {\n            if (!grpid) {\n                log.info('No Group ID!', 'grouptool');\n                return;\n            }\n\n            log.info('DELETE GROUP ' + grpid + '!', \"grouptool\");\n\n            var requests = ajax.call([{\n                methodname: 'mod_grouptool_delete_group',\n                args: {cmid: e.data.cmid, groupid: grpid},\n                fail: notif.exception\n            }]);\n            requests[0].then(function(result) {\n                // So now the group's maybe recreated by grouptool instances set to do so, show notifications!\n                notif.fetchNotifications();\n                if (!result.error) {\n                    // Success, remove the corresponding table entry...\n                    node.find('td div').slideUp(600).promise().done(function() {\n                        node.remove();\n                    });\n                } else {\n                    notif.exception(result.error);\n                }\n                log.info(\"AJAX Call to delete group \" + grpid + \" successfull\\n\" + status, \"grouptool\");\n\n                return this;\n            }).fail(notif.exception);\n        });\n    };\n\n    var instance = new Administration();\n\n    /**\n     * Initialize the JS (save params and attach event handler).\n     *\n     * @param {int} cmid\n     * @param {string} filter\n     * @param {int} filterall\n     * @param {int} globalsize\n     * @param {int} usesize\n     */\n    instance.initializer = function(cmid, filter, filterall, globalsize, usesize) {\n\n        this.cmid = cmid;\n        this.filter = filter;\n        this.filterall = filterall;\n        this.globalsize = globalsize;\n        this.usesize = usesize;\n\n        log.info('Initialize Grouptool group administration', \"grouptool\");\n        $('.path-mod-grouptool').on('click', 'tr[data-id] a[data-rename]', this, this.renamegroup);\n        log.debug(\"Init edit size button\", \"grouptool\");\n        str.get_strings([{key: 'ajax_edit_size_help', component: 'mod_grouptool'}]).done(function(s) {\n            var strings = {resizehelp: s[0]};\n            log.debug(\"String successfully retrieved: \" + s, \"grouptool\");\n            var resizedata = {instance: instance, strings: strings, globalsize: instance.globalsize};\n            $('.path-mod-grouptool').on('click', 'tr[data-id] a[data-resize]', resizedata, instance.resizegroup);\n        }).fail(function(ex) {\n            log.error(\"Error while retrieving string: \" + ex, \"grouptool\");\n        });\n        var stringstofetch = [\n            {key: 'confirm_delete_title', component: 'mod_grouptool'},\n            {key: 'confirm_delete', component: 'mod_grouptool'},\n            {key: 'yes', component: 'moodle'},\n            {key: 'no', component: 'moodle'}\n        ];\n        str.get_strings(stringstofetch).done(function(s) {\n            log.info(\"Strings successfully retrieved: \" + s, \"grouptool\");\n            var strings = {title: s[0], confirm: s[1], yes: s[2], no: s[3]};\n            $('.path-mod-grouptool .mod_grouptool_sortlist').on('click', 'tr[data-id] a[data-delete]',\n                    {cmid: instance.cmid, strings: strings}, instance.deletegroup);\n        }).fail(function(ex) {\n            log.error(\"Error while retrieving strings: \" + ex, \"grouptool\");\n        });\n        $('.path-mod-grouptool .mod_grouptool_sortlist').on('click', 'tr[data-id] a[data-toggle]', this, this.togglegroup);\n    };\n\n    return instance;\n});\n"],"names":["define","$","templates","ajax","str","murl","notif","log","Administration","cmid","filter","filterall","globalsize","prototype","renamegroup","e","info","preventDefault","stopPropagation","context","requests","target","closest","node","grpid","data","button","field","prevAll","text","infoNode","fadeOut","attr","fadeIn","focus","select","on","which","call","methodname","args","groupid","name","val","fail","exception","remove","then","result","error","render","html","hide","find","prepend","window","setTimeout","this","message","off","status","unbind","resizegroup","instance","strings","helpNode","resizehelp","parseInt","size","newvalue","togglegroup","slideUp","promise","done","length","get_strings","s","link","relativeUrl","sortlistcontainer","viewparams","prop","usesize","templatepromise","toggleClass","firstinactive","parents","first","lastactive","last","detach","insertBefore","insertAfter","newnode","addClass","replaceWith","removeClass","css","slideDown","deletegroup","hasClass","confirm","title","yes","no","fetchNotifications","initializer","debug","key","component","resizedata","ex"],"mappings":";;;;;;;;AA2BAA,sCAAO,CAAC,SAAU,iBAAkB,YAAa,WAAY,WAAY,oBAAqB,aAAa,SAASC,EAAGC,UAC/GC,KAAMC,IAAKC,KAAMC,MAAOC,SAMxBC,eAAiB,gBACZC,KAAO,OACPC,OAAS,UACTC,UAAY,UACZC,WAAa,GAQtBJ,eAAeK,UAAUC,YAAc,SAASC,GAC5CR,IAAIS,KAAK,gBAAiB,aAC1BD,EAAEE,iBACFF,EAAEG,sBAEEC,QAAU,GACVC,SAAW,GAGXC,OAASpB,EAAEc,EAAEM,QAAQC,QAAQ,iBAC7BC,KAAOF,OAAOC,QAAQ,MACtBE,MAAQD,KAAKE,KAAK,MAElBC,OAASL,OACTM,MAAQD,OAAOE,QAAQ,sBACvBC,KAAOH,OAAOE,QAAQ,aACtBE,SAAW,GACfJ,OAAOK,QAAQ,KACfJ,MAAMI,QAAQ,KACdF,KAAKE,QAAQ,KAAK,WACdJ,MAAMK,KAAK,OAAQ,QACnBL,MAAMM,OAAO,KACbN,MAAMO,QACNP,MAAMQ,YAEVR,MAAMS,GAAG,UAAW,KAAMrB,EAAEU,MAAM,SAASV,GACvB,KAAZA,EAAEsB,OAA4B,KAAZtB,EAAEsB,QACpBtB,EAAEE,iBACFF,EAAEG,mBAGU,KAAZH,EAAEsB,OACFjB,SAAWjB,KAAKmC,KAAK,CAAC,CAClBC,WAAY,6BACZC,KAAM,CAAC/B,KAAMM,EAAEU,KAAKhB,KAAMgC,QAASjB,MAAOkB,KAAMf,MAAMgB,OACtDC,KAAMtC,MAAMuC,aAEZf,WACAA,SAASC,QAAQ,KACjBD,SAASgB,UAEb1B,SAAS,GAAG2B,MAAK,SAASC,eAClBA,OAAOC,OACP9B,QAAU,SACK6B,OAAOC,OAEtB/C,UAAUgD,OAAO,0BAA2B/B,SAAS4B,MAAK,SAASI,aAC/DrB,SAAW7B,EAAEkD,OACJC,OACT7B,KAAK8B,KAAK,gBAAgBC,QAAQxB,UAClCA,SAASG,OAAO,KAEhBsB,OAAOC,YAAW,WACd1B,SAASC,QAAQ,KAAK,WAClBD,SAASgB,cAEd,KAEIW,QACRb,KAAKtC,MAAMuC,aAEd1B,QAAU,SACK6B,OAAOU,SAEtBxD,UAAUgD,OAAO,4BAA6B/B,SAAS4B,MAAK,kBAExDlB,KAAKsB,KAAKxB,MAAMgB,OAChBhB,MAAMI,QAAQ,KAAK,WACfJ,MAAMK,KAAK,QAASL,MAAMgB,OAC1BhB,MAAMK,KAAK,OAAQ,UACnBH,KAAKI,OAAO,KACZP,OAAOO,OAAO,QAElBN,MAAMgC,IAAI,WAEHF,QACRb,KAAKtC,MAAMuC,WAEdtC,IAAIS,KAAK,6BAA+BQ,MAAQ,iBAAmBoC,OAAQ,cAGxEH,QACRb,KAAKtC,MAAMuC,YAEK,KAAZ9B,EAAEsB,QACTV,MAAMI,QAAQ,KAAK,WACfF,KAAKuB,OACLzB,MAAMK,KAAK,OAAQ,UACnBL,MAAMgB,IAAId,KAAKsB,QACfxB,MAAMK,KAAK,QAASH,KAAKsB,QACzBtB,KAAKI,OAAO,KACZP,OAAOO,OAAO,QAEdH,UACAA,SAASC,QAAQ,KAAK,WAClBD,SAASgB,YAGjBnB,MAAMkC,OAAO,YAUzBrD,eAAeK,UAAUiD,YAAc,SAAS/C,GAC5CR,IAAIS,KAAK,gBAAiB,aAC1BD,EAAEE,iBACFF,EAAEG,sBAGEG,OAASpB,EAAEc,EAAEM,QAAQC,QAAQ,iBAC7BC,KAAOF,OAAOC,QAAQ,MACtBE,MAAQD,KAAKE,KAAK,MAElBhB,KAAOM,EAAEU,KAAKsC,SAAStD,KAEvBuD,QAAUjD,EAAEU,KAAKuC,QACjBpD,WAAaG,EAAEU,KAAKb,WAEpBc,OAASL,OACTM,MAAQD,OAAOE,QAAQ,sBACvBC,KAAOH,OAAOE,QAAQ,aACtBE,SAAW,GACXmC,SAAW,GAEX9C,QAAU,GACVC,SAAW,GAEfM,OAAOK,QAAQ,KACfJ,MAAMI,QAAQ,KACdF,KAAKE,QAAQ,KAAK,WACdJ,MAAMK,KAAK,OAAQ,QACnBL,MAAMM,OAAO,KACbN,MAAMO,QACNP,MAAMQ,aACFhB,QAAU,SACC6C,QAAQE,YAEvBhE,UAAUgD,OAAO,yBAA0B/B,SAAS4B,MAAK,SAASI,aAC9Dc,SAAWhE,EAAEkD,OACJC,OACT7B,KAAK8B,KAAK,aAAaC,QAAQW,UAC/BA,SAAShC,OAAO,KAETwB,QACRb,KAAKtC,MAAMuC,cAElBlB,MAAMS,GAAG,UAAW,KAAM,MAAM,SAASrB,GACrB,KAAZA,EAAEsB,OAA4B,KAAZtB,EAAEsB,QACpBtB,EAAEE,iBACFF,EAAEG,mBAGU,KAAZH,EAAEsB,OACFjB,SAAWjB,KAAKmC,KAAK,CAAC,CAClBC,WAAY,6BACZC,KAAM,CAAC/B,KAAM0D,SAAS1D,MAAOgC,QAASjB,MAAO4C,KAAMzC,MAAMgB,OACzDC,KAAMtC,MAAMuC,aAEZf,WACAA,SAASC,QAAQ,KACjBD,SAASgB,UAETmB,WACAA,SAASlC,QAAQ,KACjBkC,SAASnB,UAEb1B,SAAS,GAAG2B,MAAK,SAASC,eAClBA,OAAOC,OACP9B,QAAU,SACK6B,OAAOC,OAEtB/C,UAAUgD,OAAO,0BAA2B/B,SAAS4B,MAAK,SAASI,aAC/DrB,SAAW7B,EAAEkD,OACJC,OACT7B,KAAK8B,KAAK,aAAaC,QAAQxB,UAC/BA,SAASG,OAAO,KAEhBsB,OAAOC,YAAW,WACd1B,SAASC,QAAQ,KAAK,WAClBD,SAASgB,cAEd,KAEIW,QACRb,KAAKtC,MAAMuC,aAEd1B,QAAU,SACK6B,OAAOU,SAEtBxD,UAAUgD,OAAO,4BAA6B/B,SAAS4B,MAAK,SAASI,OACjErB,SAAW7B,EAAEkD,OACJC,OACT7B,KAAK8B,KAAK,aAAaC,QAAQxB,UAC/BA,SAASG,OAAO,SACZoC,SAAW1C,MAAMgB,YACJ,KAAb0B,SACAxC,KAAKsB,KAAKvC,WAAa,KAEvBiB,KAAKsB,KAAKkB,UAEd1C,MAAMI,QAAQ,KAAK,WACfJ,MAAMK,KAAK,QAASL,MAAMgB,OAC1BhB,MAAMK,KAAK,OAAQ,UACnBH,KAAKI,OAAO,KACZP,OAAOO,OAAO,KACdN,MAAMgC,IAAI,cAEdJ,OAAOC,YAAW,WACd1B,SAASC,QAAQ,KAAK,WAClBD,SAASgB,cAEd,KAEIW,QACRb,KAAKtC,MAAMuC,YAElBtC,IAAIS,KAAK,6BAA+BQ,MAAQ,iBAAmBoC,OAAQ,aAEpEH,QACRb,KAAKtC,MAAMuC,YAEK,KAAZ9B,EAAEsB,QACTV,MAAMI,QAAQ,KAAK,WACfF,KAAKuB,OACLzB,MAAMK,KAAK,OAAQ,UACnBL,MAAMK,KAAK,QAASH,KAAKsB,QACzBxB,MAAMgB,IAAId,KAAKsB,QACftB,KAAKI,OAAO,KACZP,OAAOO,OAAO,QAEdH,UACAA,SAASC,QAAQ,KAAK,WAClBD,SAASgB,YAGbmB,UACAA,SAASlC,QAAQ,KAAK,WAClBD,SAASgB,YAGjBnB,MAAMkC,OAAO,YAUzBrD,eAAeK,UAAUyD,YAAc,SAASvD,GAC5CA,EAAEE,iBACFF,EAAEG,sBAGEC,QAAU,GAEVE,OAASpB,EAAEc,EAAEM,QAAQC,QAAQ,iBAE7BC,KAAOF,OAAOC,QAAQ,MAEtBE,MAAQD,KAAKE,KAAK,MAEtBlB,IAAIS,KAAK,gBAAkBQ,MAAO,iBAE9BoC,OAASrC,KAAKE,KAAK,UAER,IAAXmC,SAA2B,IAAXA,QAEhBrD,IAAIS,KAAK,oBAAsBQ,MAAQ,IAAK,aAEjCrB,KAAKmC,KAAK,CAAC,CAClBC,WAAY,iCACZC,KAAM,CAAC/B,KAAMM,EAAEU,KAAKhB,KAAMgC,QAASjB,OACnCoB,KAAMtC,MAAMuC,aAEP,GAAGE,MAAK,SAASC,WAClBA,OAAOC,MAAO,KACVpB,KAAO,iCAAmCL,MAAQ,oCACtDjB,IAAIS,KAAKa,KAAOmB,OAAOC,MAAQ,KAAOW,OAAQ,iBAC3C,IACmB,WAAlB7C,EAAEU,KAAKf,OACPa,KAAK8B,KAAK,UAAUkB,QAAQ,KAAKC,UAAUC,MAAK,cAC5ClD,KAAKuB,UACA7C,EAAE,6BAA6ByE,OAAQ,CAKxCtE,IAAIuE,YAFiB,CAAC,KAAQ,2BAA+B,iBACvC,KAAQ,2BAA+B,mBAC7BF,MAAK,SAASG,OAMtCC,KAAO,YALDxE,KAAKyE,YAAY,0BAA2B,IAC5C/D,EAAEU,KAAKhB,SACN,8BACGM,EAAEU,KAAKd,YAEW,KAAQiE,EAAE,GAAK,OAC3CzD,QAAU,SACCyD,EAAE,GAAKC,MAElBE,kBAAoB9E,EAAE,0BAC1B8E,kBAAkBhD,QAAQ,KAAK,WAC3B7B,UAAUgD,OAAO,yBAA0B/B,SAAS4B,MAAK,SAASI,aAC9D4B,kBAAkB5B,KAAKA,MACvB4B,kBAAkB9C,OAAO,KAElBwB,QACRb,KAAKtC,MAAMuC,iBAEnBD,KAAKtC,MAAMuC,eAEnBD,KAAKtC,MAAMuC,eACX,KAECmC,WAAa,IACPjE,EAAEU,KAAKhB,SACN,kBAEXU,QAAU,SACI,WACC,YACEE,OAAOC,QAAQ,MAAMG,KAAK,gBACjCD,cACKH,OAAOC,QAAQ,MAAM+B,KAAK,wBAAwB4B,KAAK,gBAC1D5D,OAAOC,QAAQ,MAAMG,KAAK,gBACvBpB,KAAKyE,YAAY,0BAA2BE,YAAY,SAC1D3D,OAAOC,QAAQ,MAAMG,KAAK,mBACtBV,EAAEU,KAAKyD,aACZ7D,OAAOC,QAAQ,MAAMG,KAAK,aAElC0D,gBAAkBjF,UAAUgD,OAAO,+BAAgC/B,SAEvEI,KAAK6D,YAAY,UACjB7D,KAAK8B,KAAK,UAAUkB,QAAQ,KAAKC,UAAUC,MAAK,WAC5CU,gBAAgBpC,MAAK,SAASI,UACtBkC,cAAgB9D,KAAK+D,QAAQ,SAASjC,KAAK,4CAA4CkC,QACvFC,WAAajE,KAAK+D,QAAQ,SAASjC,KAAK,2CAA2CoC,OACnFJ,cAAcX,QACdnD,KAAKmE,SACLnE,KAAKoE,aAAaN,gBACXG,WAAWd,SAClBnD,KAAKmE,SACLnE,KAAKqE,YAAYJ,iBAEjBK,QAAU5F,EAAEkD,aAChB0C,QAAQC,SAAS,UACjBD,QAAQxC,KAAK,UAAUkB,QAAQ,GAC/BhD,KAAKwE,YAAYF,SACjBA,QAAQxC,KAAK,eAAe2C,YAAY,gBAAgBC,IAAI,SAAU,WACtEJ,QAAQT,YAAY,UACpBS,QAAQxC,KAAK,UAAU6C,UAAU,KACjC3E,KAAOsE,QAEApC,QACRb,KAAKtC,MAAMuC,cACfD,KAAKtC,MAAMuC,WAElBtC,IAAIS,KAAK,iCAAmCQ,MAAQ,iBAAmBwB,OAAOU,QAAU,KAAOE,OAC3F,oBAGDH,QACRb,KAAKtC,MAAMuC,YACI,IAAXe,SAA2B,IAAXA,QAEvBrD,IAAIS,KAAK,kBAAoBQ,MAAQ,IAAK,aAE/BrB,KAAKmC,KAAK,CAAC,CAClBC,WAAY,+BACZC,KAAM,CAAC/B,KAAMM,EAAEU,KAAKhB,KAAMgC,QAASjB,OACnCoB,KAAMtC,MAAMuC,aAEP,GAAGE,MAAK,SAASC,WAClBA,OAAOC,MAAO,KACVpB,KAAO,+BAAiCL,MAAQ,oCACpDjB,IAAIS,KAAKa,KAAOmB,OAAOC,MAAQ,KAAOW,OAAQ,iBAC3C,IACmB,aAAlB7C,EAAEU,KAAKf,OAEPa,KAAK8B,KAAK,UAAUkB,QAAQ,KAAKC,UAAUC,MAAK,cAC5ClD,KAAKuB,UACA7C,EAAE,6BAA6ByE,OAAQ,CAOxCtE,IAAIuE,YAJiB,CACjB,KAAQ,6BAAiC,iBACzC,KAAQ,2BAA+B,mBAEXF,MAAK,SAASG,OAMtCC,KAAO,YALDxE,KAAKyE,YAAY,0BAA2B,IAC5C/D,EAAEU,KAAKhB,SACN,8BACGM,EAAEU,KAAKd,YAEW,KAAQiE,EAAE,GAAK,OAC/CzD,QAAU,SACKyD,EAAE,GAAKC,UAElBE,kBAAoB9E,EAAE,0BAC1B8E,kBAAkBhD,QAAQ,KAAK,WAC3B7B,UAAUgD,OAAO,yBAA0B/B,SAAS4B,MAAK,SAASI,aAC9D4B,kBAAkB5B,KAAKA,MACvB4B,kBAAkB9C,OAAO,KAElBwB,QACRb,KAAKtC,MAAMuC,iBAEnBD,KAAKtC,MAAMuC,mBAGnB,KAECmC,WAAa,IACPjE,EAAEU,KAAKhB,SACN,kBAGXU,QAAU,SACI,WACC,YACEI,KAAKE,KAAK,gBACjBD,cACKD,KAAK8B,KAAK,wBAAwB4B,KAAK,gBAC1C1D,KAAKE,KAAK,gBACPpB,KAAKyE,YAAY,0BAA2BE,YAAY,SAC1DzD,KAAKE,KAAK,mBACNV,EAAEU,KAAKyD,aACZ3D,KAAKE,KAAK,aAElB0D,gBAAkBjF,UAAUgD,OAAO,+BAAgC/B,SACvEI,KAAK6D,YAAY,UACjB/D,OAAOC,QAAQ,MAAM+B,KAAK,UAAUkB,QAAQ,KAAKC,UAAUC,MAAK,WAC5DU,gBAAgBpC,MAAK,SAASI,UACtBkC,cAAgB9D,KAAK+D,QAAQ,SAASjC,KAAK,4CAA4CkC,QACvFC,WAAajE,KAAK+D,QAAQ,SAASjC,KAAK,2CAA2CoC,OACnFD,WAAWd,QACXnD,KAAKmE,SACLnE,KAAKqE,YAAYJ,aACVH,cAAcX,SACrBnD,KAAKmE,SACLnE,KAAKoE,aAAaN,oBAElBQ,QAAU5F,EAAEkD,aAChB0C,QAAQC,SAAS,UACjBD,QAAQxC,KAAK,UAAUkB,QAAQ,GAC/BhD,KAAKwE,YAAYF,SACjBA,QAAQxC,KAAK,eAAe2C,YAAY,gBAAgBC,IAAI,SAAU,WACtEJ,QAAQT,YAAY,UACpBS,QAAQxC,KAAK,UAAU6C,UAAU,KACjC3E,KAAOsE,QAEApC,QACRb,KAAKtC,MAAMuC,cACfD,KAAKtC,MAAMuC,WAElBtC,IAAIS,KAAK,+BAAiCQ,MAAQ,iBAAmBwB,OAAOU,QAAS,oBAGlFD,QACRb,KAAKtC,MAAMuC,YAGdtC,IAAI0C,MAAM,iBAAmBzB,MAAQ,mCAAoC,cASjFhB,eAAeK,UAAUsF,YAAc,SAASpF,MAC5CA,EAAEE,iBACFF,EAAEG,mBAEEjB,EAAEc,EAAEM,QAAQC,QAAQ,iBAAiB8E,SAAS,iBAO9C7E,KAFStB,EAAEc,EAAEM,QAAQC,QAAQ,iBAEfA,QAAQ,MAEtBE,MAAQD,KAAKE,KAAK,MAElBuC,QAAUjD,EAAEU,KAAKuC,QAErB1D,MAAM+F,QAAQrC,QAAQsC,MAAOtC,QAAQqC,QAASrC,QAAQuC,IAAKvC,QAAQwC,IAAI,WAC9DhF,OAKLjB,IAAIS,KAAK,gBAAkBQ,MAAQ,IAAK,aAEzBrB,KAAKmC,KAAK,CAAC,CACtBC,WAAY,6BACZC,KAAM,CAAC/B,KAAMM,EAAEU,KAAKhB,KAAMgC,QAASjB,OACnCoB,KAAMtC,MAAMuC,aAEP,GAAGE,MAAK,SAASC,eAEtB1C,MAAMmG,qBACDzD,OAAOC,MAMR3C,MAAMuC,UAAUG,OAAOC,OAJvB1B,KAAK8B,KAAK,UAAUkB,QAAQ,KAAKC,UAAUC,MAAK,WAC5ClD,KAAKuB,YAKbvC,IAAIS,KAAK,6BAA+BQ,MAAQ,iBAAmBoC,OAAQ,aAEpEH,QACRb,KAAKtC,MAAMuC,YAzBVtC,IAAIS,KAAK,eAAgB,sBA6BjC+C,SAAW,IAAIvD,sBAWnBuD,SAAS2C,YAAc,SAASjG,KAAMC,OAAQC,UAAWC,WAAYsE,cAE5DzE,KAAOA,UACPC,OAASA,YACTC,UAAYA,eACZC,WAAaA,gBACbsE,QAAUA,QAEf3E,IAAIS,KAAK,4CAA6C,aACtDf,EAAE,uBAAuBmC,GAAG,QAAS,6BAA8BqB,KAAMA,KAAK3C,aAC9EP,IAAIoG,MAAM,wBAAyB,aACnCvG,IAAIuE,YAAY,CAAC,CAACiC,IAAK,sBAAuBC,UAAW,mBAAmBpC,MAAK,SAASG,OAClFZ,QAAU,CAACE,WAAYU,EAAE,IAC7BrE,IAAIoG,MAAM,kCAAoC/B,EAAG,iBAC7CkC,WAAa,CAAC/C,SAAUA,SAAUC,QAASA,QAASpD,WAAYmD,SAASnD,YAC7EX,EAAE,uBAAuBmC,GAAG,QAAS,6BAA8B0E,WAAY/C,SAASD,gBACzFlB,MAAK,SAASmE,IACbxG,IAAI0C,MAAM,kCAAoC8D,GAAI,gBAQtD3G,IAAIuE,YANiB,CACjB,CAACiC,IAAK,uBAAwBC,UAAW,iBACzC,CAACD,IAAK,iBAAkBC,UAAW,iBACnC,CAACD,IAAK,MAAOC,UAAW,UACxB,CAACD,IAAK,KAAMC,UAAW,YAEKpC,MAAK,SAASG,GAC1CrE,IAAIS,KAAK,mCAAqC4D,EAAG,iBAC7CZ,QAAU,CAACsC,MAAO1B,EAAE,GAAIyB,QAASzB,EAAE,GAAI2B,IAAK3B,EAAE,GAAI4B,GAAI5B,EAAE,IAC5D3E,EAAE,+CAA+CmC,GAAG,QAAS,6BACrD,CAAC3B,KAAMsD,SAAStD,KAAMuD,QAASA,SAAUD,SAASoC,gBAC3DvD,MAAK,SAASmE,IACbxG,IAAI0C,MAAM,mCAAqC8D,GAAI,gBAEvD9G,EAAE,+CAA+CmC,GAAG,QAAS,6BAA8BqB,KAAMA,KAAKa,cAGnGP"}