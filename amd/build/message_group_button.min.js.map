{"version":3,"file":"message_group_button.min.js","sources":["../src/message_group_button.js"],"sourcesContent":["// Put this file in path/to/plugin/amd/src\n// You can call it anything you like\n\ndefine(['jquery', 'core/custom_interaction_events', 'core_message/message_drawer_helper', 'core/templates'],\n    function($, CustomEvents, MessageDrawerHelper, Templates) {\n        var SELECTORS = {\n            MESSAGE_TEXTAREA: '[data-region=\"send-message-txt\"]',\n            MESSAGE_USER_BUTTON: '#message-group-button',\n            MESSAGE_JUMP: '[data-region=\"jumpto\"]'\n        };\n\n        var TEMPLATES = {\n            CONTENT: 'core_message/message_jumpto'\n        };\n\n        /**\n         * Returns the conversation id, 0 if none.\n         *\n         * @param {object} element jQuery object for the button\n         * @return {int}\n         */\n        var getConversationId = function (element) {\n            return parseInt(element.attr('data-conversationid'));\n        };\n\n        /**\n         * Handles opening the messaging drawer to send a\n         * message to a given user.\n         *\n         * @method enhance\n         * @param {object} element jQuery object for the button\n         */\n        var send = (element) => {\n            window.console.log(element);\n            element = $(element);\n\n            var args = {\n                conversationid: getConversationId(element),\n                buttonid: $(element).attr('id'),\n            };\n            window.console.log(element);\n            window.console.log(args);\n\n            Templates.render(TEMPLATES.CONTENT, {})\n                .then(function (html) {\n                    element.after(html);\n                })\n                .then(function () {\n                    $(SELECTORS.MESSAGE_USER_BUTTON).next().focus(function () {\n                        $(SELECTORS.MESSAGE_TEXTAREA).focus();\n                    });\n                });\n\n            CustomEvents.define(element, [CustomEvents.events.activate]);\n            element.on(CustomEvents.events.activate, function (e, data) {\n                if ($(e.target).hasClass('active')) {\n                    MessageDrawerHelper.hide();\n                    $(SELECTORS.MESSAGE_USER_BUTTON).next().attr('tabindex', -1);\n                } else {\n                    $(SELECTORS.MESSAGE_USER_BUTTON).next().attr('tabindex', 0);\n                    if (args.conversationid) {\n                        MessageDrawerHelper.showConversation(args);\n                    } else {\n                        window.console.warn(\"Group conversation does not exist\");\n                    }\n                }\n                $(e.target).focus();\n                $(e.target).toggleClass('active');\n                e.preventDefault();\n                data.originalEvent.preventDefault();\n            });\n            window.console.log(\"mod_grouptool: Send was executed\");\n        };\n        return /** @alias module:core_message/message_user_button */ {\n            send: send\n        };\n    });"],"names":["define","$","CustomEvents","MessageDrawerHelper","Templates","SELECTORS","TEMPLATES","getConversationId","element","parseInt","attr","send","window","console","log","args","conversationid","buttonid","render","then","html","after","next","focus","events","activate","on","e","data","target","hasClass","hide","showConversation","warn","toggleClass","preventDefault","originalEvent"],"mappings":"AAGAA,4CAAO,CAAC,SAAU,iCAAkC,qCAAsC,mBACtF,SAASC,EAAGC,aAAcC,oBAAqBC,eACvCC,2BACkB,mCADlBA,8BAEqB,wBAIrBC,kBACS,8BASTC,kBAAoB,SAAUC,gBACvBC,SAASD,QAAQE,KAAK,+BAmD4B,CACzDC,KA1CQH,UACRI,OAAOC,QAAQC,IAAIN,SACnBA,QAAUP,EAAEO,aAERO,KAAO,CACPC,eAAgBT,kBAAkBC,SAClCS,SAAUhB,EAAEO,SAASE,KAAK,OAE9BE,OAAOC,QAAQC,IAAIN,SACnBI,OAAOC,QAAQC,IAAIC,MAEnBX,UAAUc,OAAOZ,kBAAmB,IAC/Ba,MAAK,SAAUC,MACZZ,QAAQa,MAAMD,SAEjBD,MAAK,WACFlB,EAAEI,+BAA+BiB,OAAOC,OAAM,WAC1CtB,EAAEI,4BAA4BkB,cAI1CrB,aAAaF,OAAOQ,QAAS,CAACN,aAAasB,OAAOC,WAClDjB,QAAQkB,GAAGxB,aAAasB,OAAOC,UAAU,SAAUE,EAAGC,MAC9C3B,EAAE0B,EAAEE,QAAQC,SAAS,WACrB3B,oBAAoB4B,OACpB9B,EAAEI,+BAA+BiB,OAAOZ,KAAK,YAAa,KAE1DT,EAAEI,+BAA+BiB,OAAOZ,KAAK,WAAY,GACrDK,KAAKC,eACLb,oBAAoB6B,iBAAiBjB,MAErCH,OAAOC,QAAQoB,KAAK,sCAG5BhC,EAAE0B,EAAEE,QAAQN,QACZtB,EAAE0B,EAAEE,QAAQK,YAAY,UACxBP,EAAEQ,iBACFP,KAAKQ,cAAcD,oBAEvBvB,OAAOC,QAAQC,IAAI"}