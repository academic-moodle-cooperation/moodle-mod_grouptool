{"version":3,"file":"filter.min.js","sources":["../src/filter.js"],"sourcesContent":["// This file is part of mod_grouptool for Moodle - http://moodle.org/\n//\n// It is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// It is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript for sortable groups-list\n *\n * @module   mod_grouptool/filter\n * @author    Daniel Binder\n * @copyright 2020 Academic Moodle Cooperation {@link http://www.academic-moodle-cooperation.org}\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * @module mod_grouptool/filter\n */\ndefine(['jquery', 'core/config', 'core/log'], function($, config, log) {\n\n    var Filter = function() {\n        this.baseurl = config.wwwroot + '/lib/ajax/setuserpref.php';\n    };\n\n    Filter.prototype.toogleUnoccupiedFilter = function (updatePrefs = true) {\n        $('.group-full').toggle();\n        if (updatePrefs) {\n            this.setUserPreference();\n        }\n    };\n\n    Filter.prototype.setUserPreference = function () {\n        var name = 'mod_grouptool_hideoccupied';\n        var value = false;\n        if ($('#filterunoccupied').prop('checked') === true) {\n            value = true;\n        }\n        var cfg = {\n            method: 'get',\n            url: this.baseurl,\n            data: {\n                'sesskey': config.sesskey,\n                'pref': encodeURI(name),\n                'value': encodeURI(value)\n            },\n            beforeSend: function() {\n                log.info('set user preference ' + name + ': ' + value, 'grouptool');\n            },\n            success: function() {\n                log.info('set user preference OK', 'grouptool');\n            },\n            error: function() {\n                log.error('set user preference FAILED', 'grouptool');\n            }\n        };\n        $.ajax(cfg);\n    };\n\n    return {\n        /**\n         * Initializer\n         *\n         * @param {object} params\n         */\n        init: function(params) {\n            var instance = new Filter();\n            $('#filterunoccupied').change(function() {\n                instance.toogleUnoccupiedFilter();\n            });\n            log.info(params);\n            log.info(params.filterunoccupied);\n            if(params.filterunoccupied) {\n                $('#filterunoccupied').prop('checked', true);\n                instance.toogleUnoccupiedFilter(false);\n            }\n        }\n    };\n});"],"names":["define","$","config","log","Filter","baseurl","wwwroot","prototype","toogleUnoccupiedFilter","updatePrefs","toggle","setUserPreference","name","value","prop","cfg","method","url","this","data","sesskey","encodeURI","beforeSend","info","success","error","ajax","init","params","instance","change","filterunoccupied"],"mappings":";;;;;;;;AA2BAA,8BAAO,CAAC,SAAU,cAAe,aAAa,SAASC,EAAGC,OAAQC,SAE1DC,OAAS,gBACJC,QAAUH,OAAOI,QAAU,oCAGpCF,OAAOG,UAAUC,uBAAyB,eAAUC,uEAChDR,EAAE,eAAeS,SACbD,kBACKE,qBAIbP,OAAOG,UAAUI,kBAAoB,eAC7BC,KAAO,6BACPC,OAAQ,GACmC,IAA3CZ,EAAE,qBAAqBa,KAAK,aAC5BD,OAAQ,OAERE,IAAM,CACNC,OAAQ,MACRC,IAAKC,KAAKb,QACVc,KAAM,SACSjB,OAAOkB,aACVC,UAAUT,YACTS,UAAUR,QAEvBS,WAAY,WACRnB,IAAIoB,KAAK,uBAAyBX,KAAO,KAAOC,MAAO,cAE3DW,QAAS,WACLrB,IAAIoB,KAAK,yBAA0B,cAEvCE,MAAO,WACHtB,IAAIsB,MAAM,6BAA8B,eAGhDxB,EAAEyB,KAAKX,MAGJ,CAMHY,KAAM,SAASC,YACPC,SAAW,IAAIzB,OACnBH,EAAE,qBAAqB6B,QAAO,WAC1BD,SAASrB,4BAEbL,IAAIoB,KAAKK,QACTzB,IAAIoB,KAAKK,OAAOG,kBACbH,OAAOG,mBACN9B,EAAE,qBAAqBa,KAAK,WAAW,GACvCe,SAASrB,wBAAuB"}