{"version":3,"file":"filter.min.js","sources":["../src/filter.js"],"sourcesContent":["// This file is part of mod_grouptool for Moodle - http://moodle.org/\n//\n// It is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// It is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript for sortable groups-list\n *\n * @module   mod_grouptool/filter\n * @author    Daniel Binder\n * @copyright 2020 Academic Moodle Cooperation {@link http://www.academic-moodle-cooperation.org}\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * @module mod_grouptool/filter\n */\ndefine(['jquery', 'core/config', 'core/log'], function($, config, log) {\n\n    var Filter = function() {\n        this.baseurl = config.wwwroot + '/lib/ajax/setuserpref.php';\n    };\n\n    Filter.prototype.toogleUnoccupiedFilter = function (updatePrefs = true) {\n        $('.group-full').toggle();\n        if (updatePrefs) {\n            this.setUserPreference();\n        }\n    };\n\n    Filter.prototype.setUserPreference = function () {\n        var name = 'mod_grouptool_hideoccupied';\n        var value = false;\n        if ($('#filterunoccupied').prop('checked') === true) {\n            value = true;\n        }\n        var cfg = {\n            method: 'get',\n            url: this.baseurl,\n            data: {\n                'sesskey': config.sesskey,\n                'pref': encodeURI(name),\n                'value': encodeURI(value)\n            },\n            beforeSend: function() {\n                log.info('set user preference ' + name + ': ' + value, 'grouptool');\n            },\n            success: function() {\n                log.info('set user preference OK', 'grouptool');\n            },\n            error: function() {\n                log.error('set user preference FAILED', 'grouptool');\n            }\n        };\n        $.ajax(cfg);\n    };\n\n    return {\n        /**\n         * Initializer\n         *\n         * @param {object} params\n         */\n        init: function(params) {\n            var instance = new Filter();\n            $('#filterunoccupied').change(function() {\n                instance.toogleUnoccupiedFilter();\n            });\n            log.info(params);\n            log.info(params.filterunoccupied);\n            if(params.filterunoccupied) {\n                $('#filterunoccupied').prop('checked', true);\n                instance.toogleUnoccupiedFilter(false);\n            }\n        }\n    };\n});"],"names":["define","$","config","log","Filter","this","baseurl","wwwroot","prototype","toogleUnoccupiedFilter","updatePrefs","toggle","setUserPreference","name","value","prop","cfg","method","url","data","sesskey","encodeURI","beforeSend","info","success","error","ajax","init","params","instance","change","filterunoccupied"],"mappings":";;;;;;;;AA2BAA,OAAO,uBAAA,CAAC,SAAU,cAAe,aAAa,SAASC,EAAGC,OAAQC,KAE9D,IAAIC,OAAS,WACTC,KAAKC,QAAUJ,OAAOK,QAAU,6BAqC7B,OAlCPH,OAAOI,UAAUC,uBAAyB,WAAUC,IAAAA,uEAChDT,EAAE,eAAeU,SACbD,aACAL,KAAKO,qBAIbR,OAAOI,UAAUI,kBAAoB,WAC7BC,IAAAA,KAAO,6BACPC,OAAQ,GACmC,IAA3Cb,EAAE,qBAAqBc,KAAK,aAC5BD,OAAQ,GAEZ,IAAIE,IAAM,CACNC,OAAQ,MACRC,IAAKb,KAAKC,QACVa,KAAM,CACSjB,QAAAA,OAAOkB,QACVC,KAAAA,UAAUR,MACTQ,MAAAA,UAAUP,QAEvBQ,WAAY,WACRnB,IAAIoB,KAAK,uBAAyBV,KAAO,KAAOC,MAAO,cAE3DU,QAAS,WACLrB,IAAIoB,KAAK,yBAA0B,cAEvCE,MAAO,WACHtB,IAAIsB,MAAM,6BAA8B,eAGhDxB,EAAEyB,KAAKV,MAGJ,CAMHW,KAAM,SAASC,QACX,IAAIC,SAAW,IAAIzB,OACnBH,EAAE,qBAAqB6B,QAAO,WAC1BD,SAASpB,4BAEbN,IAAIoB,KAAKK,QACTzB,IAAIoB,KAAKK,OAAOG,kBACbH,OAAOG,mBACN9B,EAAE,qBAAqBc,KAAK,WAAW,GACvCc,SAASpB,wBAAuB"}